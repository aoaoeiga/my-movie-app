<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ˜ ç”»è¨ºæ–­ã‚¢ãƒ—ãƒª</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;
    function MovieFinderApp() {
      const [step, setStep] = useState(0);
      const [answers, setAnswers] = useState({});
      const [movie, setMovie] = useState(null);
      const [loading, setLoading] = useState(false);
      const genreMap = { action: 28, comedy: 35, drama: 18, horror: 27, romance: 10749, scifi: 878, thriller: 53, animation: 16, fantasy: 14, mystery: 9648, crime: 80, documentary: 99 };
      const japaneseAwardMovies = [
        { title: 'ä¾ã‚¿ã‚¤ãƒ ã‚¹ãƒªãƒƒãƒ‘ãƒ¼', year: 2024, isAnime: false, isAward: true },
        { title: 'ã‚´ã‚¸ãƒ©-1.0', year: 2023, isAnime: false, isAward: true },
        { title: 'å›ã®åã¯ã€‚', year: 2016, isAnime: true, isAward: true },
        { title: 'åƒã¨åƒå°‹ã®ç¥éš ã—', year: 2001, isAnime: true, isAward: true }
      ];
      const questions = [
        { id: 'language', question: 'è¨€èªã¯ï¼Ÿ', emoji: 'ğŸŒ', options: [{ value: 'ja', label: 'æ—¥æœ¬èª', emoji: 'ğŸ‡¯ğŸ‡µ' }, { value: 'en', label: 'è‹±èª', emoji: 'ğŸ‡ºğŸ‡¸' }] }
      ];
      const handleAnswer = (questionId, value) => { setAnswers(prev => ({ ...prev, [questionId]: value })); if (step < questions.length - 1) { setTimeout(() => setStep(step + 1), 300); } };
      const findMovie = async () => {
        setLoading(true);
        try {
          const response = await fetch('/api/movies', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ answers, japaneseAwardMovies, genreMap }) });
          const data = await response.json();
          if (data.error) { alert(data.error); } else { setMovie(data); }
        } catch (error) { alert('ã‚¨ãƒ©ãƒ¼: ' + error.message); } finally { setLoading(false); }
      };
      const reset = () => { setStep(0); setAnswers({}); setMovie(null); };
      const currentQuestion = questions[step];
      const allAnswered = Object.keys(answers).length === questions.length;
      if (loading) { return (<div className="min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 flex items-center justify-center"><div className="text-6xl animate-bounce">ğŸ¬</div></div>); }
      if (movie) { return (<div className="min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 p-6"><div className="max-w-4xl mx-auto"><div className="bg-white/5 rounded-3xl p-8"><h3 className="text-5xl font-black text-white mb-4">{movie.title}</h3><p className="text-blue-100 text-lg">{movie.desc}</p><button onClick={reset} className="mt-6 bg-gradient-to-r from-yellow-400 to-pink-500 text-white py-4 px-8 rounded-xl font-bold">æœ€åˆã‹ã‚‰</button></div></div></div>); }
      return (<div className="min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 p-6"><div className="max-w-2xl mx-auto"><h1 className="text-6xl font-black text-white mb-8 text-center">ğŸ¬ æ˜ ç”»è¨ºæ–­</h1><div className="bg-white/10 rounded-3xl p-10"><div className="text-center mb-8"><div className="text-7xl mb-4">{currentQuestion.emoji}</div><h2 className="text-4xl font-bold text-white">{currentQuestion.question}</h2></div><div className="grid gap-4 grid-cols-2">{currentQuestion.options.map(option => (<button key={option.value} onClick={() => handleAnswer(currentQuestion.id, option.value)} className="p-6 rounded-2xl font-bold bg-white/20 hover:bg-white/30 text-white"><div className="text-4xl mb-2">{option.emoji}</div><div className="text-lg">{option.label}</div></button>))}</div>{allAnswered && <button onClick={findMovie} className="w-full mt-6 bg-gradient-to-r from-yellow-400 to-purple-500 text-white py-4 rounded-xl text-xl font-black">âœ¨ æ˜ ç”»ã‚’è¦‹ã¤ã‘ã‚‹ï¼ ğŸ¬</button>}</div></div></div>);
    }
    ReactDOM.render(<MovieFinderApp />, document.getElementById('root'));
  </script>
</body>
</html>
